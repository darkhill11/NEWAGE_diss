---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(tidyverse)
library(readxl)
library(extrafont)
library(showtext)

#font_import()

loadfonts(device = "win")
```

```{r}
ets_prices <-  read_excel("report_pivot_merged.xlsx", sheet = "pco2_ets_yr")
netsr_prices <- read_excel("report_pivot_merged.xlsx", sheet = "pco2_netsr_yr")
```

```{r}
ets_prices$Region = "EU28"
ets_prices <- ets_prices[, c(1,4,2,3)]
```

```{r}
all_prices <- rbind(ets_prices, netsr_prices)
```

```{r}
all_prices_filter <- all_prices %>%
  filter(Year == 2030) %>%
  subset(Region %in% c("EU28",
                       "DEU",
                       "FRA",
                       "ITA",
                       "POL",
                       "UKI",
                       "ESP",
                       "BNL",
                       "EUN",
                       "EUS"))

all_prices_filter[[1]] = toupper(all_prices_filter[[1]])


```

```{r}
ref_prices <- filter(all_prices_filter, Scenario == "REF" & Region == "EU28")

all_prices_filter <- filter(all_prices_filter, Scenario != "REF")

all_prices_filter <- rbind(all_prices_filter, ref_prices)

all_prices_filter <- all_prices_filter %>% mutate(Scenario = factor(Scenario, levels = c("INV",
                                "CAP",
                                "LAB",
                                "VAT",
                                "BAU",
                                "REF")))

```

```{r}
plot_price <-ggplot(all_prices_filter, aes(x = Scenario, y = Value))

plot_price +
  geom_boxplot(data = filter(all_prices_filter, Region != "EU28"), aes(fill = Scenario)) +
  geom_point(data = filter(all_prices_filter, Region == "EU28" | Region == "DEU"), aes(shape = Region), size = 3) +
  scale_y_continuous(name = "Price of t.eqCO2 [â‚¬ 2011]",
                     breaks = seq(0, 600,100)) +
  theme_bw() +
  theme(text         = element_text(size=10, family="Palatino Linotype"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title = element_text(size = 12),
        strip.text = element_text(size = 12),
        legend.text = element_text(size = 12),
        legend.title = element_text(size = 12),
        legend.position = "bottom")
```
Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
