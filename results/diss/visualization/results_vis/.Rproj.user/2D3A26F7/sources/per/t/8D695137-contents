---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(tidyverse)
library(readxl)
library(extrafont)
library(showtext)

#font_import()

loadfonts(device = "win")
```

```{r}
co2_gdp_share <-  read_excel("report_pivot_merged.xlsx", sheet = "share_co2_gdp")

```

```{r}
co2_gdp_share_filter <- co2_gdp_share %>%
  filter(Year == 2030, Type == "total") %>%
    subset(Region %in% c("DEU",
                       "FRA",
                       "ITA",
                       "POL",
                       "UKI",
                       "ESP",
                       "BNL",
                       "EUN",
                       "EUS",
                       "EU28"))

co2_gdp_share_filter$Region <- gsub("DEU","Germany", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("FRA","France", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("ITA","Italy", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("UKI","UK", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("POL","Poland", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("ESP","Spain and \nPortugal", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("BNL","Benelux", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("EUN","Northern EU", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("EUS","Central and \nSoutheastern EU", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Region <- gsub("EU28","EU-28 \naverage", co2_gdp_share_filter$Region)
co2_gdp_share_filter$Scenario <- gsub("vat","con", co2_gdp_share_filter$Scenario)

co2_gdp_share_filter$Region <- ordered(co2_gdp_share_filter$Region, levels = c("EU28","EU-28 \naverage",
                            "Germany",
                            "France",
                            "Italy",
                            "UK",
                            "Poland",
                            "Spain and \nPortugal",
                            "Benelux",
                            "Northern EU",
                            "Central and \nSoutheastern EU"))

co2_gdp_share_filter[[1]] = toupper(co2_gdp_share_filter[[1]])

co2_gdp_share_filter$Scenario <- ordered(co2_gdp_share_filter$Scenario, levels = c("REF",
                            "BAU",
                            "CON",
                            "LAB",
                            "CAP",
                            "INV"))

```

```{r}

plot <- ggplot(data = co2_gdp_share_filter, aes(y = Value, x = Scenario))

plot +
  geom_jitter(aes(color = Region), size = 4, width = 0.2) +
  scale_color_brewer(palette="Paired", name = "Region") +
  scale_y_continuous(name = "CO2 payments as share of GDP",
                     breaks = seq(0, 0.04,0.005),
                     labels = scales::label_percent(accuracy = 0.1)) +
  theme_bw() +
  theme(text         = element_text(size=10, family="Palatino Linotype"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title = element_text(size = 12),
        strip.text = element_text(size = 12),
        legend.text = element_text(size = 12),
        legend.title = element_text(size = 12),
        legend.position = "bottom")

ggsave(width = 8, height = 4, filename = "gdp_co2_share.png")

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
