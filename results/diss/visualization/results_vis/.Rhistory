library(tidyverse)
library(readxl)
#read gdp data from results
gdp_disag <- read_excel("report_pivot_merged.xlsx", sheet = "gdpreal_disag_yr")
View(gdp_disag)
gdp_diff <- spread(gdp_disag, key = "Scenario", value = "Value")
View(gdp_diff)
gdp_diff <- spread(gdp_disag, key = "Scenario", value = "Value")
gdp_diff %>% mutate(bau = (bau-ref)/ref)
# Spread scenarios to be able to change them
gdp_diff <- spread(gdp_disag, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
gdp_diff <- gdp_diff %>% mutate(bau = (bau-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(cAP = (cAP-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(inv = (inv-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(lab = (lab-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(vat = (vat-ref)/ref)
# drop non-EU regions and years after 2030
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
gdp_diff_filter <- filter(gdp_diff_filter, grepl('2011|2015|2020|2025|2030', Region))
View(gdp_diff_filter)
# drop non-EU regions and years after 2030
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
#gdp_diff_filter <- filter(gdp_diff_filter, grepl('2011|2015|2020|2025|2030', Region))
View(gdp_diff_filter)
# drop non-EU regions and years after 2030
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
gdp_diff_filter <- filter(gdp_diff_filter, grepl(2011|2015|2020|2025|2030, Region))
# drop non-EU regions and years after 2030
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
gdp_diff_filter <- filter(gdp_diff_filter, grepl('2011|2015|2020|2025|2030', Year))
# drop non-EU regions and years after 2030
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
gdp_diff_filter <- filter(gdp_diff_filter, grepl('2011|2015|2020|2025|2030', Year))
# drop ref
gdp_diff_filter <- subset(gdp_diff_filter, select = -c(ref))
# gather scenarios
gdp_diff_filter <- gather(gdp_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# drop non-EU regions, years after 2030 and categories that are not 'total'
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
gdp_diff_filter <- filter(gdp_diff_filter, grepl('2011|2015|2020|2025|2030', Year))
gdp_diff_filter <- filter(gdp_diff_filter, grepl('total', Type))
# drop ref
gdp_diff_filter <- subset(gdp_diff_filter, select = -c(ref, Type))
# gather scenarios
gdp_diff_filter <- gather(gdp_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
plot_gdp <- ggplot(data = gdp_filter, aes(y = Scenario, x = Value))
plot_gdp <- ggplot(data = gdp_diff_filter, aes(y = Scenario, x = Value))
plot_gdp +
geom_point
plot_gdp <- ggplot(data = gdp_diff_filter, aes(y = Scenario, x = Value))
plot_gdp +
geom_point()
plot_gdp <- ggplot(data = gdp_diff_filter, aes(y = Scenario, x = Value))
plot_gdp +
geom_point(size = 3, alpha =0.5)
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_boxplot()
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_jitter(size = 3, alpha =0.5)
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_violin()
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_violin() +
facet_wrap(Year)
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_violin() +
facet_wrap(~Year)
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_point(color = Region) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_point(colour = Region) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = gdp_diff_filter, aes(x = Scenario, y = Value))
plot_gdp +
geom_point(colours = Region) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(x = Scenario, y = Value))
plot_gdp +
geom_jitter(aes(colours = Region), alpha = 0.3, size = 3) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(x = Scenario, y = Value))
plot_gdp +
geom_jitter(aes(colour = Region), alpha = 0.3, size = 3) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(x = Scenario, y = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.3, size = 3) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(x = Scenario, y = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.3, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.3, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3) +
facet_wrap(~Year)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.3, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3, color = "red") +
facet_wrap(~Year)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.3, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3, color = "red") +
facet_wrap(~Year) +
scale_x_continuous(albels = scales::percent
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.3, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3, color = "red") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3, color = "red") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3, color = "red") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent, breaks = (-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3, color = "red") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent, breaks = seq(-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent, breaks = seq(-0.2, 0.1,0.05))
# drop non-EU regions, years after 2030 and categories that are not 'total'
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
gdp_diff_filter <- filter(gdp_diff_filter, grepl('2011|2015|2020|2025|2030', Year))
gdp_diff_filter <- filter(gdp_diff_filter, Type == 'total'))
# drop non-EU regions, years after 2030 and categories that are not 'total'
gdp_diff_filter <- filter(gdp_diff, grepl('DEU|FRA|ITA|UKI|POL|BNL|ESP|EUN|EUS|EU-28', Region))
gdp_diff_filter <- filter(gdp_diff_filter, grepl('2011|2015|2020|2025|2030', Year))
gdp_diff_filter <- filter(gdp_diff_filter, Type == 'total')
# drop ref
gdp_diff_filter <- subset(gdp_diff_filter, select = -c(ref, Type))
# gather scenarios
gdp_diff_filter <- gather(gdp_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent, breaks = seq(-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scaleFUN, breaks = seq(-0.2, 0.1,0.05))
scaleFUN <- function(x) sprintf("%.4f", x)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scaleFUN, breaks = seq(-0.2, 0.1,0.05))
scaleFUN <- function(x) sprintf("%", x)
scaleFUN <- function(x) sprintf("%.f", x)
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scaleFUN, breaks = seq(-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent, breaks = seq(-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent(accuracy = 1), breaks = seq(-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent(accuracy = 0.1), breaks = seq(-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::percent, breaks = seq(-0.2, 0.1,0.05))
plot_gdp <- ggplot(data = filter(gdp_diff_filter, Year > 2022), aes(y = Scenario, x = Value))
plot_gdp +
geom_point(aes(colour = Region), alpha = 0.2, size = 3) +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "EU-28"), aes(colour = Region), alpha = 1, size = 3.5, color = "red") +
geom_point(data = filter(gdp_diff_filter, Year > 2022 & Region == "DEU"), aes(colour = Region), alpha = 1, size = 3.5, color = "black") +
facet_wrap(~Year) +
scale_x_continuous(labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.2, 0.1,0.05))
