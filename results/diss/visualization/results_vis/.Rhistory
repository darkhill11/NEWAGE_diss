facet_grid(Region ~ Sector)
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector)
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Non Energy Intensive \nIndustries")) %>%
mutate(Type = str_replace(Type, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Non Energy Intensive \nIndustries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_diff_filter <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_diff_filter <- filter(gva_diff_filter, grepl('2030', Year))
gva_diff_filter <- filter(gva_diff_filter, grepl('energy|Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_diff_filter <- subset(gva_diff_filter, select = -c(ref))
# gather scenarios
gva_diff_filter <- gather(gva_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_diff_filter[[4]] = toupper(gva_diff_filter[[4]])
gva_diff_filter$Scenario <- factor(gva_diff_filter$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Non Energy Intensive \nIndustries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Sector = str_replace(Sector, "energy", "Energy")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_diff_filter <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_diff_filter <- filter(gva_diff_filter, grepl('2030', Year))
gva_diff_filter <- filter(gva_diff_filter, grepl('Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_diff_filter <- subset(gva_diff_filter, select = -c(ref))
# gather scenarios
gva_diff_filter <- gather(gva_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_diff_filter[[4]] = toupper(gva_diff_filter[[4]])
gva_diff_filter$Scenario <- factor(gva_diff_filter$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Non Energy Intensive \nIndustries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Other Industries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_diff_filter <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_diff_filter <- filter(gva_diff_filter, grepl('2030', Year))
gva_diff_filter <- filter(gva_diff_filter, grepl('Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_diff_filter <- subset(gva_diff_filter, select = -c(ref))
# gather scenarios
gva_diff_filter <- gather(gva_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_diff_filter[[4]] = toupper(gva_diff_filter[[4]])
gva_diff_filter$Scenario <- factor(gva_diff_filter$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Other Industries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_diff_filter <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_diff_filter <- filter(gva_diff_filter, grepl('2030', Year))
gva_diff_filter <- filter(gva_diff_filter, grepl('Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_diff_filter <- subset(gva_diff_filter, select = -c(ref))
# gather scenarios
gva_diff_filter <- gather(gva_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_diff_filter[[4]] = toupper(gva_diff_filter[[4]])
gva_diff_filter$Scenario <- factor(gva_diff_filter$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gva_diff_filter$Sector <- factor(gva_diff_filter$Sector, levels = c("Energy Intensive Ind",
"non-Energy Intensive Ind",
"SER",
"Other Sectors"))
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Other Industries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
# Spread scenarios to be able to change them
gva_diff <- spread(gva_real, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
gva_diff <- gva_diff %>% mutate(bau = (bau-ref)/ref)
gva_diff <- gva_diff %>% mutate(cAP = (cAP-ref)/ref)
gva_diff <- gva_diff %>% mutate(inv = (inv-ref)/ref)
gva_diff <- gva_diff %>% mutate(lab = (lab-ref)/ref)
gva_diff <- gva_diff %>% mutate(vat = (vat-ref)/ref)
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_diff_filter <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_diff_filter <- filter(gva_diff_filter, grepl('2030', Year))
gva_diff_filter <- filter(gva_diff_filter, grepl('Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_diff_filter <- subset(gva_diff_filter, select = -c(ref))
# gather scenarios
gva_diff_filter <- gather(gva_diff_filter, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_diff_filter[[4]] = toupper(gva_diff_filter[[4]])
gva_diff_filter$Scenario <- factor(gva_diff_filter$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gva_diff_filter$Sector <- factor(gva_diff_filter$Sector, levels = c("Energy Intensive Ind",
"non-Energy Intensive Ind",
"SER",
"Other Sectors"))
gva_diff_filter <- gva_diff_filter %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Other Industries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ Sector) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive Ind",
"non-Energy Intensive Ind",
"SER",
"Other Sectors"))) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
library(tidyverse)
library(readxl)
library(extrafont)
library(showtext)
#font_import()
loadfonts()
#read gdp data from results
gdp_disag <- read_excel("report_pivot_merged.xlsx", sheet = "gdpreal_disag_yr")
# Spread scenarios to be able to change them
gdp_diff <- spread(gdp_disag, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
gdp_diff <- gdp_diff %>% mutate(bau = (bau-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(cAP = (cAP-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(inv = (inv-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(lab = (lab-ref)/ref)
gdp_diff <- gdp_diff %>% mutate(vat = (vat-ref)/ref)
# drop non-EU regions, years after 2030 and categories that are not 'total'
gdp_diff_filter_2 <- filter(gdp_diff, grepl('DEU|EU28', Region))
gdp_diff_filter_2 <- filter(gdp_diff_filter_2, grepl('2030', Year))
gdp_diff_filter_2 <- filter(gdp_diff_filter_2, Type != 'total' & Type != 'total_no_cons_tax')
# drop ref
gdp_diff_filter_2 <- subset(gdp_diff_filter_2, select = -c(ref))
# gather scenarios
gdp_diff_filter_2 <- gather(gdp_diff_filter_2, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
gdp_diff_filter_2[[4]] = toupper(gdp_diff_filter_2[[4]])
gdp_diff_filter_2$Scenario <- factor(gdp_diff_filter_2$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gdp_diff_filter_2 <- gdp_diff_filter_2 %>%
mutate(Type = str_replace(Type, "cons_gov", "Government's \nConsumption")) %>%
mutate(Type = str_replace(Type, "cons_hh", "Households' \nConsumption")) %>%
mutate(Type = str_replace(Type, "inv", "Investments")) %>%
mutate(Type = str_replace(Type, "trade", "Trade")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
#font_import(pattern = "lmroman*")
#loadfonts()
#font_import()
loadfonts(device = "win")
windowsFonts()
plot_gdp <- ggplot(data = gdp_diff_filter_2, aes(x = Scenario, y = Value))
plot_gdp +
geom_bar(stat="identity",aes(fill = Scenario), color = black) +
facet_grid( Region ~ Type) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.2, 0.15,0.05)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gdp <- ggplot(data = gdp_diff_filter_2, aes(x = Scenario, y = Value))
plot_gdp +
geom_bar(stat="identity",aes(fill = Scenario), color = "black") +
facet_grid( Region ~ Type) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.2, 0.15,0.05)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.2, 0.15,0.05)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), ) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.025, 0.02,0.01)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.025, 0.02,0.005)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_diff_filter, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.025, 0.02,0.01)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
# Spread scenarios to be able to change them
gva_diff <- spread(gva_real, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
gva_diff <- gva_diff %>% mutate(bau = (bau-ref)/ref)
gva_diff <- gva_diff %>% mutate(cAP = (cAP-ref)/ref)
gva_diff <- gva_diff %>% mutate(inv = (inv-ref)/ref)
gva_diff <- gva_diff %>% mutate(lab = (lab-ref)/ref)
gva_diff <- gva_diff %>% mutate(vat = (vat-ref)/ref)
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_secs <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_secs <- filter(gva_secs, grepl('2030', Year))
gva_secs <- filter(gva_secs, grepl('Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_secs <- subset(gva_secs, select = -c(ref))
# gather scenarios
gva_secs <- gather(gva_secs, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_secs[[4]] = toupper(gva_secs[[4]])
gva_secs$Scenario <- factor(gva_secs$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gva_secs$Sector <- factor(gva_secs$Sector, levels = c("Energy Intensive Ind",
"non-Energy Intensive Ind",
"SER",
"Other Sectors"))
gva_secs <- gva_secs %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Other Industries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_secs, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.025, 0.02,0.01)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
