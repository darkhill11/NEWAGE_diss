scale_fill_manual(name = "Regions",
labels = c("Germany", "EU-28"),
values = c("yellow", "blue")) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
axis.title = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
ggsave(width = 6, height = 5, filename = "gva_dev.png")
library(tidyverse)
library(readxl)
library(extrafont)
library(showtext)
loadfonts(device = "win")
#read emplyment data from results
gva_real <- read_excel("report_pivot_merged.xlsx", sheet = "gva_real_yr")
# Spread scenarios to be able to change them
gva_diff <- spread(gva_real, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
gva_diff <- gva_diff %>% mutate(bau = (bau-ref)/ref)
gva_diff <- gva_diff %>% mutate(cAP = (cAP-ref)/ref)
gva_diff <- gva_diff %>% mutate(inv = (inv-ref)/ref)
gva_diff <- gva_diff %>% mutate(lab = (lab-ref)/ref)
gva_diff <- gva_diff %>% mutate(vat = (vat-ref)/ref)
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_secs <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_secs <- filter(gva_secs, grepl('2030', Year))
gva_secs <- filter(gva_secs, grepl('Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_secs <- subset(gva_secs, select = -c(ref))
# gather scenarios
gva_secs <- gather(gva_secs, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_secs[[4]] = toupper(gva_secs[[4]])
gva_secs$Scenario <- factor(gva_secs$Scenario, levels = c("INV",
"CAP",
"LAB",
"VAT",
"BAU"))
gva_secs$Sector <- factor(gva_secs$Sector, levels = c("Energy Intensive Ind",
"non-Energy Intensive Ind",
"SER",
"Other Sectors"))
gva_secs <- gva_secs %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Other Industries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_secs, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.025, 0.02,0.01)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
# drop non-EU regions, years after 2030 and categories that are not 'total'
gva_secs <- filter(gva_diff, grepl('DEU|EU28', Region))
gva_secs <- filter(gva_secs, grepl('2030', Year))
gva_secs <- filter(gva_secs, grepl('Energy Intensive Ind|non-Energy Intensive Ind|Other Sectors|SER', Sector))
# drop ref
gva_secs <- subset(gva_secs, select = -c(ref))
# gather scenarios
gva_secs <- gather(gva_secs, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
gva_secs[[4]] = toupper(gva_secs[[4]])
gva_secs$Scenario <- factor(gva_secs$Scenario, levels = c("BAU",
"VAT",
"LAB",
"CAP",
"INV"))
gva_secs$Sector <- factor(gva_secs$Sector, levels = c("Energy Intensive Ind",
"non-Energy Intensive Ind",
"SER",
"Other Sectors"))
gva_secs <- gva_secs %>%
mutate(Sector = str_replace(Sector, "SER", "Services")) %>%
mutate(Sector = str_replace(Sector, "non-Energy Intensive Ind", "Other Industries")) %>%
mutate(Sector = str_replace(Sector, "Energy Intensive Ind", "Energy Intensive \nIndustries")) %>%
mutate(Region = str_replace(Region, "DEU", "Germany")) %>%
mutate(Region = str_replace(Region, "EU28", "EU-28"))
plot_gva <- ggplot(data = gva_secs, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L), breaks = seq(-0.025, 0.02,0.01)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
plot_gva <- ggplot(data = gva_secs, aes(x = Scenario, y = Value))
plot_gva +
geom_bar(stat='identity', aes(fill =  Scenario), color = "black") +
facet_grid(Region ~ factor(Sector, levels = c("Energy Intensive \nIndustries",
"Other Industries",
"Services",
"Other Sectors"))) +
scale_y_continuous(name = "Difference to reference scenario [REF]",
labels = scales::label_percent(accuracy = 1L)) +
theme_bw()+
theme(text         = element_text(size=10, family="Palatino Linotype"),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.title.y = element_text(size = 12),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12),
legend.position = "bottom")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(extrafont)
library(showtext)
loadfonts(device = "win")
ra_hh_par <- read_excel("report_pivot_merged.xlsx", sheet = "ra_hh_par_yr")
ra_hh_par <- read_excel("report_pivot_merged.xlsx", sheet = "RA_hh_par_yr")
cons_hh <- read_excel("report_pivot_merged.xlsx", sheet = "cons_hh_accounts_yr")
ra_hh_par <- read_excel("report_pivot_merged.xlsx", sheet = "RA_hh_par_yr")
cons_hh <- read_excel("report_pivot_merged.xlsx", sheet = "cons_hh_accounts")
View(ra_hh_par)
ra_hh_par_filter <- ra_hh_par %>%
filter(Sector == "total_income", Scenario != "ref", Year == 2030)
View(cons_hh)
ra_hh_par <- read_excel("report_pivot_merged.xlsx", sheet = "RA_hh_par_yr")
cons_hh <- read_excel("report_pivot_merged.xlsx", sheet = "cons_hh_accounts")
ra_hh_par <- read_excel("report_pivot_merged.xlsx", sheet = "RA_hh_par_yr")
cons_hh <- read_excel("report_pivot_merged.xlsx", sheet = "cons_hh_accounts")
ra_hh_par_filter <- ra_hh_par %>%
filter(Sector == "total_income", Scenario != "ref", Year == 2030)
cons_hh_filter <- cons_hh %>%
filter(Sector == "CO2_NETSr" | Sector == "CO2_inv_pay", Scenario != "ref", Year == 2030)
View(cons_hh_filter)
View(ra_hh_par_filter)
View(cons_hh_filter)
cons_hh_filter <- cons_hh %>%
filter(Sector == "CO2_NETSr" | Sector == "CO2_inv_pay", Scenario != "ref", Year == 2030)
cons_hh_filter %>% rename(Value = cons_hh)
cons_hh_filter <- cons_hh %>%
filter(Sector == "CO2_NETSr" | Sector == "CO2_inv_pay", Scenario != "ref", Year == 2030)
cons_hh_filter %>% rename(cons_hh = Value)
ra_hh_par_filter <- ra_hh_par %>%
filter(Sector == "total_income", Scenario != "ref", Year == 2030)
ra_hh_par_filter <- ra_hh_par_filter %>% rename(ra_hh = Value)
cons_hh_filter <- cons_hh %>%
filter(Sector == "CO2_NETSr" | Sector == "CO2_inv_pay", Scenario != "ref", Year == 2030)
cons_hh_filter <- cons_hh_filter %>% rename(cons_hh = Value)
full_join(ra_hh_par_filter, cons_hh_filter, by=c("Region", "Scenario", "Year", "HH"))
View(cons_hh_filter)
View(ra_hh_par_filter)
ra_hh_par_filter <- ra_hh_par %>%
filter(Sector == "total_income", Scenario != "ref", Year == 2030)
ra_hh_par_filter <- ra_hh_par_filter[-c(2)] %>% rename(ra_hh = Value)
cons_hh_filter <- cons_hh %>%
filter(Sector == "CO2_NETSr" | Sector == "CO2_inv_pay", Scenario != "ref", Year == 2030)
cons_hh_filter <- cons_hh_filter[-c(4)] %>%
rename(cons_hh = Value)
full_join(ra_hh_par_filter, cons_hh_filter, by=c("Region", "Scenario", "Year", "HH"))
tax_incidence <- full_join(ra_hh_par_filter, cons_hh_filter, by=c("Region", "Scenario", "Year", "HH"))
tax_incidence %>% mutate(incidence = cons_hh/ra_hh)
tax_incidence <- full_join(ra_hh_par_filter, cons_hh_filter, by=c("Region", "Scenario", "Year", "HH"))
tax_incidence <- tax_incidence %>% mutate(incidence = cons_hh/ra_hh)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = region))
incidence_plot +
geom_point() +
geom_line() +
facet_wrap(~Scenario)
View(incidence_plot)
View(tax_incidence)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region))
incidence_plot +
geom_point() +
geom_line() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region))
incidence_plot +
geom_point() +
geom_path) +
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region))
incidence_plot +
geom_point() +
geom_path()) +
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region))
incidence_plot +
geom_point() +
geom_path() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region, group=1))
incidence_plot +
geom_point() +
geom_path() +
facet_wrap(~Scenario)
View(tax_incidence)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region, group=1))
incidence_plot +
geom_point() +
geom_path() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region, group=Region))
incidence_plot +
geom_point() +
geom_path() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(filter(tax_incidence, Region = "EUN"), aes(x=HH, y=incidence, color = Region, group=Region))
incidence_plot <- ggplot(filter(tax_incidence, Region == "EUN"), aes(x=HH, y=incidence, color = Region, group=Region))
incidence_plot +
geom_point() +
geom_path() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(filter(tax_incidence, Region == "EUS"), aes(x=HH, y=incidence, color = Region, group=Region))
incidence_plot +
geom_point() +
geom_path() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence))
incidence_plot +
geom_violin() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence))
incidence_plot +
geom_boxplot() +
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, group = Region))
incidence_plot +
geom_point() +
geom_line()+
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region, group = Region))
incidence_plot +
geom_point() +
geom_line()+
facet_wrap(~Scenario)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region, group = Region))
incidence_plot +
geom_point() +
geom_line()+
facet_wrap(~Scenario, ncol = 5)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region, group = Region))
incidence_plot +
geom_point() +
geom_line()+
facet_wrap(~Scenario, ncol = 3)
ra_hh_par_filter <- ra_hh_par %>%
filter(Sector == "net_income", Scenario != "ref", Year == 2030)
ra_hh_par_filter <- ra_hh_par_filter[-c(2)] %>% rename(ra_hh = Value)
cons_hh_filter <- cons_hh %>%
filter(Sector == "CO2_NETSr" | Sector == "CO2_inv_pay", Scenario != "ref", Year == 2030)
cons_hh_filter <- cons_hh_filter[-c(4)] %>%
rename(cons_hh = Value)
tax_incidence <- full_join(ra_hh_par_filter, cons_hh_filter, by=c("Region", "Scenario", "Year", "HH"))
tax_incidence <- tax_incidence %>% mutate(incidence = cons_hh/ra_hh)
incidence_plot <- ggplot(tax_incidence, aes(x=HH, y=incidence, color = Region, group = Region))
incidence_plot +
geom_point() +
geom_line()+
facet_wrap(~Scenario, ncol = 3)
library(tidyverse)
library(readxl)
library(extrafont)
library(showtext)
loadfonts(device = "win")
#read emplyment data from results
energy_cons <- read_excel("report_pivot_merged.xlsx", sheet = "energy_cons_sec_yr")
View(energy_cons)
View(cons_hh)
View(energy_cons)
enrgy_cons_filter <- energy_cons %>%
filter(Year == 2030, Sector %in% c("hh1", "hh2", "hh3", "hh4", "hh5"))
View(enrgy_cons_filter)
# Spread scenarios to be able to change them
energy_cons_diff <- spread(energy_cons_filter, key = "Scenario", value = "Value")
enrgy_cons_filter <- energy_cons %>%
filter(Year == 2030, Sector %in% c("hh1", "hh2", "hh3", "hh4", "hh5"))
# Spread scenarios to be able to change them
energy_cons_diff <- spread(energy_cons_filter, key = "Scenario", value = "Value")
energy_cons_filter <- energy_cons %>%
filter(Year == 2030, Sector %in% c("hh1", "hh2", "hh3", "hh4", "hh5"))
# Spread scenarios to be able to change them
energy_cons_diff <- spread(energy_cons_filter, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
energy_cons_diff <- energy_cons_diff %>% mutate(bau = (bau-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(cAP = (cAP-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(inv = (inv-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(lab = (lab-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(vat = (vat-ref)/ref)
# drop ref
energy_cons_diff <- subset(energy_cons_diff, select = -c(ref))
# gather scenarios
energy_cons_diff <- gather(energy_cons_diff, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
View(energy_cons_diff)
# Spread scenarios to be able to change them
energy_cons_diff <- spread(energy_cons_filter, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
energy_cons_diff <- energy_cons_diff %>% mutate(bau = (bau-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(cAP = (cAP-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(inv = (inv-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(lab = (lab-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(vat = (vat-ref)/ref)
# drop ref
energy_cons_diff <- subset(energy_cons_diff, select = -c(ref))
# gather scenarios
energy_cons_diff <- gather(energy_cons_diff, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
energy_cons_diff[[5]] = toupper(energy_cons_diff[[5]])
energy_cons_diff$Scenario <- factor(energy_cons_diff$Scenario, levels = c("BAU",
"VAT",
"LAB",
"CAP",
"INV"))
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU"), aes(x=Value, y=Sector))
energy_plot +
geom_bar() +
facet_grid(HH ~ Scenario)
View(energy_cons_diff)
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU"), aes(x=Value, y=Fuel))
energy_plot +
geom_bar() +
facet_grid(Sector ~ Scenario)
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU"), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Sector ~ Scenario)
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU", Sector %in% c("hh1", "hh3", "hh5")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Sector ~ Scenario)
# Spread scenarios to be able to change them
energy_cons_abs <- spread(energy_cons_filter, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
energy_cons_abs <- energy_cons_abs %>% mutate(bau = (bau-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(cAP = (cAP-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(inv = (inv-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(lab = (lab-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(vat = (vat-ref))
# drop ref
energy_cons_abs <- subset(energy_cons_abs, select = -c(ref))
# gather scenarios
energy_cons_abs <- gather(energy_cons_abs, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
energy_cons_abs[[5]] = toupper(energy_cons_abs[[5]])
energy_cons_abs$Scenario <- factor(energy_cons_abs$Scenario, levels = c("BAU",
"VAT",
"LAB",
"CAP",
"INV"))
energy_plot <- ggplot(filter(energy_cons_abs, Region == "DEU", Sector %in% c("hh1", "hh3", "hh5")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Sector ~ Scenario)
View(energy_cons)
energy_cons_filter <- energy_cons %>%
filter(Year == 2030, Sector %in% c("hh1", "hh2", "hh3", "hh4", "hh5"))
energy_cons_filter <- energy_cons_filter %>%
spread(key = "Fuel", value = "Value") %>%
mutate(FF = oil + gas + COL + CRU) %>%
gather("oil", "gas", "COL", "CRU", "FF", "ele", "total", key = "Fuel", value = "Value")
# Spread scenarios to be able to change them
energy_cons_diff <- spread(energy_cons_filter, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
energy_cons_diff <- energy_cons_diff %>% mutate(bau = (bau-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(cAP = (cAP-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(inv = (inv-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(lab = (lab-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(vat = (vat-ref)/ref)
# drop ref
energy_cons_diff <- subset(energy_cons_diff, select = -c(ref))
# gather scenarios
energy_cons_diff <- gather(energy_cons_diff, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
energy_cons_diff[[5]] = toupper(energy_cons_diff[[5]])
energy_cons_diff$Scenario <- factor(energy_cons_diff$Scenario, levels = c("BAU",
"VAT",
"LAB",
"CAP",
"INV"))
# Spread scenarios to be able to change them
energy_cons_abs <- spread(energy_cons_filter, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
energy_cons_abs <- energy_cons_abs %>% mutate(bau = (bau-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(cAP = (cAP-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(inv = (inv-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(lab = (lab-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(vat = (vat-ref))
# drop ref
energy_cons_abs <- subset(energy_cons_abs, select = -c(ref))
# gather scenarios
energy_cons_abs <- gather(energy_cons_abs, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
energy_cons_abs[[5]] = toupper(energy_cons_abs[[5]])
energy_cons_abs$Scenario <- factor(energy_cons_abs$Scenario, levels = c("BAU",
"VAT",
"LAB",
"CAP",
"INV"))
energy_plot <- ggplot(filter(energy_cons_abs, Region == "DEU",
Sector %in% c("hh1", "hh3", "hh5"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Sector ~ Scenario)
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU",
Sector %in% c("hh1", "hh3", "hh5"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Sector ~ Scenario)
energy_plot <- ggplot(filter(energy_cons_abs, Region == "DEU",
Sector %in% c("hh1", "hh3", "hh5"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Sector ~ Scenario)
energy_plot <- ggplot(filter(energy_cons_abs, Region == "DEU",
Sector %in% c("hh1", "hh3", "hh5"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Scenario ~ Sector)
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU",
Sector %in% c("hh1", "hh3", "hh5"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Scenario ~ Sector)
energy_cons_filter <- energy_cons %>%
filter(Year == 2030, Sector %in% c("hh1", "hh2", "hh3", "hh4", "hh5", "sum_hh"))
energy_cons_filter <- energy_cons_filter %>%
spread(key = "Fuel", value = "Value") %>%
mutate(FF = oil + gas + COL + CRU) %>%
gather("oil", "gas", "COL", "CRU", "FF", "ele", "total", key = "Fuel", value = "Value")
# Spread scenarios to be able to change them
energy_cons_diff <- spread(energy_cons_filter, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
energy_cons_diff <- energy_cons_diff %>% mutate(bau = (bau-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(cAP = (cAP-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(inv = (inv-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(lab = (lab-ref)/ref)
energy_cons_diff <- energy_cons_diff %>% mutate(vat = (vat-ref)/ref)
# drop ref
energy_cons_diff <- subset(energy_cons_diff, select = -c(ref))
# gather scenarios
energy_cons_diff <- gather(energy_cons_diff, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
energy_cons_diff[[5]] = toupper(energy_cons_diff[[5]])
energy_cons_diff$Scenario <- factor(energy_cons_diff$Scenario, levels = c("BAU",
"VAT",
"LAB",
"CAP",
"INV"))
# Spread scenarios to be able to change them
energy_cons_abs <- spread(energy_cons_filter, key = "Scenario", value = "Value")
# Transform each scenario into the relative difference to reference scenario
energy_cons_abs <- energy_cons_abs %>% mutate(bau = (bau-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(cAP = (cAP-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(inv = (inv-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(lab = (lab-ref))
energy_cons_abs <- energy_cons_abs %>% mutate(vat = (vat-ref))
# drop ref
energy_cons_abs <- subset(energy_cons_abs, select = -c(ref))
# gather scenarios
energy_cons_abs <- gather(energy_cons_abs, 'bau', 'cAP', 'inv', 'vat', 'lab', key = 'Scenario', value = 'Value')
# update scenario names and change order
energy_cons_abs[[5]] = toupper(energy_cons_abs[[5]])
energy_cons_abs$Scenario <- factor(energy_cons_abs$Scenario, levels = c("BAU",
"VAT",
"LAB",
"CAP",
"INV"))
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU",
Sector %in% c("hh1", "hh3", "hh5", "sum_hh"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Scenario ~ Sector)
energy_plot <- ggplot(filter(energy_cons_diff, Region == "DEU",
Sector %in% c("sum_hh"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Scenario ~ Sector)
energy_plot <- ggplot(filter(energy_cons_abs, Region == "DEU",
Sector %in% c("hh1", "hh3", "hh5"),
Fuel %in% c("FF", "ele", "total")), aes(x=Value, y=Fuel))
energy_plot +
geom_col() +
facet_grid(Scenario ~ Sector)
